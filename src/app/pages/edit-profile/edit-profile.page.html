<ion-content class="ion-padding" color="default">
  <ion-header class="ion-no-border safe-area"> </ion-header>
  <div class="ion-text-center">
    <ion-card-title class="center" color="dark">Edit Profile</ion-card-title>
  </div>
  <ion-fab vertical="top" horizontal="end" slot="fixed">
    <ion-button
      (click)="cancel()"
      routerDirection="back"
      type="button"
      size="default"
      shape="circle"
      color="primary"
    >
      <ion-icon name="close"></ion-icon>
    </ion-button>
  </ion-fab>

  <ng-container *ngIf="user$ | async as user; else loading ">
    <div id="choose-avatar" (click)="setAvatarOptionOpen(true)" class="avatar">
      <user-avatar [user]="user" [enableShowPic]="false" class="avatar"></user-avatar>
      <ion-button color="medium" shape="round" size="small">edit</ion-button>
    </div>

  <!-- 
    <ion-item button (click)="openModal('name')">
      <ion-label>Name</ion-label>
      <ion-text slot="end">{{user.firstName}}&nbsp;{{user.lastName}}</ion-text>
    </ion-item>
    <ion-item button (click)="openModal('username')">
      <ion-label>Userame</ion-label>
      <ion-text slot="end">{{user.username}}</ion-text>
    </ion-item>
    <ion-item button (click)="openModal('dob')">
      <ion-label>Age</ion-label>
      <ion-text slot="end">{{getAge(user)}}</ion-text>
    </ion-item>
    <ion-item button (click)="openModal('sex')">
      <ion-label>Gender</ion-label>
      <ion-text slot="end">{{user.gender}}</ion-text>
    </ion-item>
    <ion-item button (click)="numberPickerService.openWeightPicker(user)">
      <ion-label>Weight</ion-label>
      <ion-text slot="end">{{user.weight}}</ion-text>
    </ion-item>
    <ion-item button (click)="numberPickerService.openHeightPicker(user)">
      <ion-label>Height</ion-label>
      <ion-text slot="end">{{user.height.feet}}' {{user.height.inches}}"</ion-text>
    </ion-item>
   -->

    <ion-accordion-group>
      <ion-accordion>
        <ion-item slot="header">
          <ion-label>Name</ion-label>
          <ion-text slot="end">{{user.firstName}}&nbsp;{{user.lastName}}</ion-text>
        </ion-item>
        <div class="ion-padding" slot="content" color="light">
          <ion-input label="First Name" [(ngModel)]="user.firstName"></ion-input>
          <ion-input label="Last Name" [(ngModel)]="user.lastName"></ion-input>
        </div>
      </ion-accordion>
      <ion-accordion>
        <ion-item slot="header">
          <ion-label>Userame</ion-label>
          <ion-text slot="end">{{user.username}}</ion-text>
        </ion-item>
        <div class="ion-padding" slot="content">
          <ion-input></ion-input>
        </div>
      </ion-accordion>
      <ion-accordion>
        <ion-item slot="header">
          <ion-label>Age</ion-label>
          <ion-text slot="end">{{getAge(user)}}</ion-text>
        </ion-item>
        <div class="ion-padding" slot="content">
          <ion-datetime [(ngModel)]="user.dob" class="date-picker"
          presentation="date" [preferWheel]="true" [max]="today"></ion-datetime>
        </div>
      </ion-accordion>
      <ion-accordion>
        <ion-item slot="header">
          <ion-label>Gender</ion-label>
          <ion-text slot="end">{{user.gender}}</ion-text>
        </ion-item>
        <div class="ion-padding align-center" slot="content">
          <ion-radio-group [value]="user.gender">
          <ion-grid>
            <ion-row>
              <ion-col>
                <ion-button size="large" class="gender-button">
                  <ion-icon slot="icon-only" name="male" size="large"></ion-icon>
                </ion-button>
              </ion-col>
              <ion-col>
                <ion-button size="large" class="gender-button">
                  <ion-icon slot="icon-only" name="female" size="large"></ion-icon>
                </ion-button>
              </ion-col>
            </ion-row>
            <ion-row>
              <ion-col>
                <ion-radio value="Male" labelPlacement="stacked" alignment="center">Male</ion-radio>
              </ion-col>
              <ion-col>
                <ion-radio value="Female" labelPlacement="stacked" alignment="center">Female</ion-radio>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-radio-group>
        </div>
      </ion-accordion>
      <ion-accordion>
        <ion-item slot="header">
          <ion-label>Weight</ion-label>
          <ion-text slot="end">{{user.weight}}</ion-text>
        </ion-item>
        <div class="ion-padding" slot="content">
          <app-number-picker class="number-picker" [min]="0" [max]="325" [units]="'lbs'"
            [(pickerValue)]="user.weight"
          ></app-number-picker>
        </div>
      </ion-accordion>
      <ion-accordion>
        <ion-item slot="header">
          <ion-label>Height</ion-label>
          <ion-text slot="end">{{user.height.feet}}' {{user.height.inches}}"</ion-text>
        </ion-item>
        <div class="ion-padding" slot="content">edit username</div>
      </ion-accordion>
    <ion-list-header class="section_header">Account</ion-list-header>
    <ion-item>
      <ion-label>Email</ion-label>
      <ion-text slot="end">{{user.email}}</ion-text>
    </ion-item>
    <ion-item button>
      <ion-label>Change Password</ion-label>
      <ion-text slot="end">******</ion-text>
    </ion-item>
    <ion-item button (click)="deleteAccount()">
      <ion-label>Delete Account</ion-label>
      <ion-text slot="end"></ion-text>
    </ion-item>
    <ion-item button (click)="logout()">
      <ion-label color="danger">Log Out</ion-label>
    </ion-item>
  </ion-accordion-group>
</ng-container>

  <ng-template #loading>
    <ion-spinner color="primary"></ion-spinner>
  </ng-template>

  <ion-modal id="avatarOption"
    [isOpen]="isAvatarOptionOpen"
    (ionModalDidDismiss)="onDidDismiss($event)"
    [initialBreakpoint]="1" [breakpoints]="[0, 1]">
    <ng-template>
      <ion-header>
        <ion-toolbar color="default">
          <ion-title>Select option</ion-title>
          <ion-buttons slot="end">
            <!-- <ion-button (click)="setAvatarOpen(false)">cancel</ion-button> -->
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-list>
        <ion-item lines="none" (click)="chooseFromLibrary()">
          <ion-icon name="image-outline" slot="start"></ion-icon>
          <ion-label>Choose from library</ion-label>
        </ion-item>
        <ion-item lines="none" (click)="takePhoto()">
          <ion-icon name="camera-outline" slot="start"></ion-icon>
          <ion-label>Take a photo</ion-label>
        </ion-item>
        <ion-item lines="none" (click)="openModal('avatar')">
          <ion-icon name="happy-outline" slot="start"></ion-icon>
          <ion-label>Select a character</ion-label>
        </ion-item>
      </ion-list>
      <div class="bottom-padding"></div>
    </ng-template>
  </ion-modal>

  <ion-modal id="editAvatar" [isOpen]="isEditAvatarOpen">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-buttons slot="start">
            <ion-button size="large" (click)="cancelEditImage()">
              <ion-icon name="close-outline"></ion-icon>
            </ion-button>
          </ion-buttons>
          <ion-buttons slot="end">
            <!-- <ion-button (click)="rotate()">
              <ion-icon slot="icon-only" name="sync-outline"></ion-icon>
            </ion-button> -->
            <ion-button (click)="saveImage()">
              <ion-icon slot="icon-only" name="checkmark-outline"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <image-cropper
        #cropper
        format="png"
        [output]="'blob'"
        [imageBase64]="imageUrl"
        [aspectRatio]="1 / 1"
        [autoCrop]="false"
        [hideResizeSquares]="isMobile"
        [maintainAspectRatio]="true"
        [resizeToHeight]="256"
        [resizeToWidth]="256"
        [roundCropper]="true"
        [transform]="transform"
        (imageLoaded)="imageLoaded()"
        (loadImageFailed)="loadImageFailed()"
        (imageCropped)="imageCropped($event)"
      ></image-cropper>
      <ion-footer></ion-footer>
    </ng-template>
  </ion-modal>


</ion-content>
